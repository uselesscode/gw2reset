/*!
 * gw2reset.js v1.0.0
 * Copyright 2015 Peter Johnson
 * MIT license
 * 2015-1-20
 * https://github.com/uselesscode/gw2reset
 */
var gw2reset=function(){"use strict";var t={},n=1,e=18,r=1,u="_gw2reset_guid",a=36e5,i=1e3,o=3*i,c=function(t){return t.setUTCHours(0),t.setUTCMinutes(0),t.setUTCSeconds(0),t.setUTCMilliseconds(0),t},l=function(t){return 5===t.getUTCDay()},f=function(t){return 6===t.getUTCDay()},s=function(t,n){var e=t.getUTCHours();return n>e?!0:!1},v=function(t,n){var e,r=t.getUTCDay();return e=n-r,e+=0>=e?7:0,t.setUTCDate(t.getUTCDate()+e),t=c(t)},T=function(t){return v(t,5)},U=function(t){return v(t,6)},g=function(t){return v(t,0)},C=function(){var t=new Date;return t=c(t),t.setUTCDate(t.getUTCDate()+1),t},D=function(){var t=C();return t.setUTCDate(t.getUTCDate()-1),t},d=function(){var t=new Date;return g(t)},m=function(){var t=d();return t.setUTCDate(t.getUTCDate()-7),t},x=function(){var t=new Date;return f(t)&&s(t,n)||(t=U(t)),t=c(t),t.setUTCHours(n),t},W=function(){var t=x();return t.setUTCDate(t.getUTCDate()-7),t},b=function(){var t=new Date;return l(t)&&s(t,e)||(t=T(t)),t=c(t),t.setUTCHours(e),t},w=function(){var t=b();return t.setUTCDate(t.getUTCDate()-7),t},k=function(t){var n=t.getTime()-Date.now();return n/=2,n>a&&(n=a),o>n&&(n=i),Math.floor(n)},y={},p=function(t,n){var e;return t.some(function(t,r){return t[u]===n?(e=r,!0):!1}),e},N=function(t){var n=Date.now(),e=y[t];n>e.next.getTime()&&(e.next=e.getNext(),e.callbacks.forEach(function(t){t()})),null!==e.timer&&(e.timer=setTimeout(N.bind(null,t),k(e.next)))},h=function(t){y[t].callbacks.length>0&&null===y[t].timer&&(y[t].next=y[t].getNext(),y[t].timer=!1,N(t))},E=function(t){var n=y[t],e=n.timer;null!==e&&e!==!1&&clearTimeout(e),n.timer=null},H=function(t,n){n[u]||(n[u]=r,r+=1),y[t].callbacks.push(n),h(t)},A=function(t,n){var e;n?(e=p(y[t].callbacks,n[u]),void 0!==e&&y[t].callbacks.splice(e,1)):y[t].callbacks=[],y[t].callbacks.length<1&&E(t)},M=function(t,n){y[t]={add:H.bind(null,t),clear:A.bind(null,t),callbacks:[],timer:null,next:null,getNext:n}},_=function(t){return function(n){y[t].add(n)}},S=function(t){return function(n){y[t].clear(n)}},j=_("daily"),q=_("guild"),z=_("NAWvW"),B=_("EUWvW"),F=S("daily"),G=S("guild"),I=S("NAWvW"),J=S("EUWvW");return M("daily",C),M("guild",d),M("NAWvW",x),M("EUWvW",b),t.daily={next:C,previous:D,on:j,off:F},t.guild={next:d,previous:m,on:q,off:G},t.wvw={na:{next:x,previous:W,on:z,off:I},eu:{next:b,previous:w,on:B,off:J}},t}();